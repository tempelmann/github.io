---
layout: post
title: Debugging Tips (using local objects to your advantage)
date: '2013-08-17T23:14:00.001+01:00'
author: Thomas Tempelmann
tags:
- Xojo
modified_time: '2013-10-12T08:32:07.239+01:00'
blogger_id: tag:blogger.com,1999:blog-8797526579651167122.post-5551956878034744257
blogger_orig_url: https://blog.tempel.org/2013/08/debugging-tips-using-local-objects-to.html
---

<br /><span style="font-family: Arial, Helvetica, sans-serif;">(This is a repost of an article of mine on Real Software's, now Xojo Inc's, <a href="http://www.realsoftwareblog.com/" target="_blank">former blog</a>)</span><br /><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span> <span style="font-family: Arial, Helvetica, sans-serif;">In this article I am going to share a nifty way to help with debugging your code.&nbsp;</span><span style="font-family: Arial, Helvetica, sans-serif;">There are times when you need to figure out which methods of your code are called when.&nbsp;</span><span style="font-family: Arial, Helvetica, sans-serif;">A common solution for this is to add lines like this to your code:</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>Sub myMethod()</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>System.DebugLog CurrentMethodName + " Entered"</span><br /><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">  </span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>... your code ...</span><br /><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">  </span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>System.DebugLog CurrentMethodName + " Exited"</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>End Sub</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">This can quickly get overwhelming if the methods you want to test have lots of exit points, i.e. return statements, as you'll have to spot all of those and add a line before each of the return statements. It gets even worse if the return statement calls a function, like this:</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>return mySubroutine()</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">To get this right, you'd have to modify your code like this:</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>dim tmpResult as String = mySubroutine()</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>System.DebugLog CurrentMethodName + " Exited"</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>return tmpResult</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">But there's a much simpler solution which brings along a few other enhancements as well:&nbsp;</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">Use an object that exists for the time the method is running, like this:</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>Sub myMethod()</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>dim myTmpObject as new MethodProfiler(CurrentMethodName)</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">With this construct, you create an object of class&nbsp;</span><span style="font-family: Arial, Helvetica, sans-serif;">MethodProfiler</span><span style="font-family: Arial, Helvetica, sans-serif;">&nbsp;at the start of the method, and it'll be destructed automatically when the method is exited. That's all thanks to RB's method of reference-counted object management (it wouldn't work with the garbage disposal management as it's used by Java and Objective C).</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">The&nbsp;</span><span style="font-family: Arial, Helvetica, sans-serif;">MethodProfiler</span><span style="font-family: Arial, Helvetica, sans-serif;">&nbsp;class just needs its constructor and destructor methods implemented, like this:</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>Sub Constructor(name as String)</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>System.DebugLog "&lt;"+name+"&gt; Entered"</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>mName = name</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>End Sub</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>Sub Destructor()</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>LogMsg "&lt;"+mName+"&gt; Exited"</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>End Sub</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">No more need to add numerous DebugLog calls before return statements.</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">But wait, there's more!</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">With that single class taking care of all the tracking, you can easily add code to have it measure the time that the method takes to execute. And it could count the depth, allowing you to indent the output, making it more readable if you have nested calls you want to trace.</span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">For your convenience, here is a demo project with a ready-to-use MethodProfiler class:&nbsp;<a href="http://files.tempel.org/RB/MethodProfiler.rbp.zip">http://files.tempel.org/RB/MethodProfiler.rbp.zip</a></span><br /><br /><span style="font-family: Arial, Helvetica, sans-serif;">Also, if you have at least a <i>Basic license</i>&nbsp;for my tool Arbed, you can use <a href="http://www.tempel.org/Arbed" target="_blank">Arbed</a> to add these MethodProfiler invocations to all methods of your project in one easy step. See this <a href="https://forum.xojo.com/5569-how-do-you-debug-this/p1#p39787" target="_blank">Xojo forum article</a> for instructions.</span><br /><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span><span style="font-family: Arial, Helvetica, sans-serif;">Enjoy.</span>