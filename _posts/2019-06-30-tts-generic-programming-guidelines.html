---
layout: post
title: 
date: '2019-06-30T11:42:00.001+01:00'
author: Thomas Tempelmann
tags:
- Xojo
modified_time: '2019-07-01T11:38:36.077+01:00'
blogger_id: tag:blogger.com,1999:blog-8797526579651167122.post-6570380888229491556
blogger_orig_url: https://blog.tempel.org/2019/06/tts-generic-programming-guidelines.html
---

<h1 id="toc_0" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.8em; margin: 0px 0px 1em; padding: 0px;">TT's generic programming guidelines</h1><h2 id="toc_1" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Declare your local variables close to where they're used</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Do not declare all your variables at the top. Instead, declare them where you use them first. That makes it easier to see their type and also leads to better locality, avoiding accidental use of stale (old) values.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Bad style:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">var i as integer<br />var item as FileReference<br />var files() as FileReference<br /><br />for i = 1 to directory.Count<br />    item = directory.Item(i)<br />    if item.isRegularFile then<br />        files.Append item<br />    end<br />next</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Better style:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">var files() as FileReference<br /><br />for i <u>as integer</u> = 1 to directory.Count<br />    <u>var item as FileReference</u> = directory.Item(i)<br />    if item.isRegularFile then<br />        files.Append item<br />    end<br />next</code></pre></div><h2 id="toc_2" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Working with Booleans</h2><h3 id="toc_3" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.4em; margin: 1em 0px 0.6em; padding: 0px;">Naming</h3><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Functions, properties and variables of boolean type should be named so that, when reading them in a statement, end up with proper grammar.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><strong style="-webkit-print-color-adjust: exact;">Examples:</strong></div><ul style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><li style="-webkit-print-color-adjust: exact;">function isHidden() as boolean</li><li style="-webkit-print-color-adjust: exact;">var hasVisibleItems as boolean</li></ul><h3 id="toc_4" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.4em; margin: 1em 0px 0.6em; padding: 0px;">Avoid testing for true &amp; false</h3><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">It isn't good style to write boolean tests like this:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if hidden = true then ... // bad style</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">nor:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if hidden = false then ... // bad style</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Instead, along with the naming rule above learn to make it into a proper sentence:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if isHidden then ... // good style</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">and:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if not isHidden then ... // good style</code></pre></div><h2 id="toc_5" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Keep function code concise</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Avoid having long functions. Ideally, a function (subroutine) should have no more than 20-40 code lines, so that it's easy to look at in a single editor page, without scrolling.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If the code gets longer, try to split it up into subroutines, even if those subroutines only get called once by your shortened main function. And if you manage to name these subroutines in a good way, so that each subroutine's name expresses clearly what it does, your main function will be quite self-explanatory about what it does, without the need for comments.</div><h2 id="toc_6" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Exit early, avoiding nested if / else constructs</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Compare these alternative ways to code the same result (which is to collect hidden files into an array, and returning errors otherwise).</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Convoluted version (sub-optimal):</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if fileReference.isValid then<br />    if fileReference.isDirectory then<br />        if fileReference.isHidden then<br />            hiddenFiles.Append fileReference<br />            return true<br />        else<br />            return false<br />        end<br />    else<br />        return false<br />    end<br />else<br />    return false<br />end</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Alternative, better readable, version:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">if not fileReference.isValid then<br />    return false<br />end<br />if not fileReference.isDirectory then<br />    return false<br />end<br />if not fileReference.isHidden then<br />    return false<br />end<br />hiddenFiles.Append fileReference<br />return true</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">The latter version is not necessarily shorter - it may even be longer. But by sorting out all the "bad" cases first, it makes it clear what's left over in the end. This flow of control is easily to oversee because you do not have to scan for the&nbsp;<em style="-webkit-print-color-adjust: exact;">else</em>&nbsp;parts that may be coming for each&nbsp;<em style="-webkit-print-color-adjust: exact;">if</em>.</div><h2 id="toc_7" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Avoid code duplication</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Whenever you have the urge to copy some code and modify it for a similar purpose, don't do it! (There are always exceptions, of course.)</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Duplicated code can easily lead to mistakes later when you find an issue with it and only end up changing the one case where you see the issue but then forget to also update the other copies of the code that perform similar operations and need to get fixed as well.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Instead, instead of copying lines and then making small changes to the copied lines, share the same code by putting them into a subroutine, and if there are different details to perform for one or the other, add a parameter that will tell the subroutine what to do. What way, most of the code will be the same and doesn't need to be duplicated.<br /><br /><div style="-webkit-print-color-adjust: exact; font-family: Arial, sans-serif;">More on this:&nbsp;<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" style="-webkit-print-color-adjust: exact;">DRY</a></div></div><h2 id="toc_8" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Avoid getting the same values repeatedly</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Consider this code that iterates over values in an array:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">for i as integer = 0 to items.count-1<br />    if <u>items(i)</u>.isSelected then<br />        addToResult (<u>items(i)</u>)<br />    end<br />next</code></pre></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Note that&nbsp;<em style="-webkit-print-color-adjust: exact;">items(i)</em>&nbsp;is fetched twice here. Avoid doing that. Not only may it make your code slower, it also can make it more difficult to alter your code later. Instead, use a local variable to fetch the value and use that, even if that makes the code sligtly longer:</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px;"><pre style="-webkit-print-color-adjust: exact; border: 1px solid rgb(217, 217, 217); font-family: &quot;Andale Mono&quot;, &quot;Courier New&quot;, monospace; padding: 14px; white-space: pre-wrap; word-wrap: break-word;"><code class="language-none" style="-webkit-print-color-adjust: exact;">for i as integer = 0 to items.count-1<br />    var item as MyItemType = <u>items(i)</u><br />    if item.isSelected then<br />        addToResult (item)<br />    end<br />next</code></pre></div><h2 id="toc_9" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Document what you want to achieve in your code</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If you write code to implement any kind of algorithm, such as searching for matching words in a text (string), don't add comments about the obvious that your code does. Instead, write comments that explain what the code is&nbsp;<em style="-webkit-print-color-adjust: exact;">supposed</em>&nbsp;to do. E.g, explain the algorithm you want to write as code. That way, if you make a mistake in your code, you or someone else can later understand what was planned to be happening in the code, and can fix the code accordingly.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If you do not explain the&nbsp;<em style="-webkit-print-color-adjust: exact;">intent</em>&nbsp;of the code, then it is difficult later to understand if an unexpected result is a bug or an intentional behavior, and when that happens, people tend to not touch the questionable code and instead add another copy of the code which behaves slightly different (with the bug fix in it), and soon you have a mess of duplicate code that will lead to a difficult-to-maintain overall project.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If in doubt, ask your fellow programmer who wrote the original code about the intention and then add the documentation once it's clear. Then add your fix and maybe also add a comment why you fixed it that way, explaining how it changes old behavior.</div><h2 id="toc_10" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Document the behavior of a function</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If you write a function, it can also be helpful that you write in plain english what you expect the passed parameters to contain and what the result will be. Also: What will happen if they do not meet the expections?</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">For example, if you write a function that returns the index of the occurance of a string in an array of strings, explain what happens if the item is not found at all (you could return -1, the index past the last item or raise an exception), and what happens if there are multiple possible results (will it return the index of the first or of the last occurance, or will it even do something else to indicate that the result is ambiguous).</div><h2 id="toc_11" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Avoid side effects</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Functions should not have side effects, i.e. they should not modify state outside of their scope. The reason for this is that such side effects are hard to detect and thus difficult to debug.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">For instance, if you make a function that calculates something and returns a result, that function should not also change some properties or static vars unless they're solely meant for that function (such as for caching).</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">If you want to maintain state, pass the variables/objects for keeping the state as (inout, byref) parameters to the function, so that the caller knows that a state has changed, and can decide where to store it.</div><h2 id="toc_10" style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 1.6em; margin: 1em 0px 0.6em; padding: 0px;">Use a version control system for tracking each of your changes</h2><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;">Use&nbsp;<em style="-webkit-print-color-adjust: exact;">git</em>&nbsp;or something like that, and&nbsp;<em style="-webkit-print-color-adjust: exact;">commit</em>&nbsp;your changes frequently, even if you work all by your own.</div><div style="-webkit-print-color-adjust: exact; background-color: white; font-family: Arial, sans-serif; font-size: 11px; text-align: justify;"><br /></div><div style="background-color: white; font-family: arial, sans-serif; text-align: justify;"><div style="font-size: 11px;">For instance, if you are fixing a bug, commit that fix as a single commit, so that, if one later suspects that your bug fix was causing new problems, the particular commit can be undone easily to check whether that changes the result of the new problem.</div><h2 id="toc_11" style="-webkit-print-color-adjust: exact; font-family: Arial, sans-serif; margin: 1em 0px 0.6em; padding: 0px; text-align: start;"><span style="font-size: large;">More</span></h2><div style="-webkit-print-color-adjust: exact; font-family: Arial, sans-serif; font-size: 11px;">See&nbsp;<a href="http://www.tempel.org/TTsCodingGuidelines" style="-webkit-print-color-adjust: exact;">this older article of mine</a>&nbsp;on some more guidelines</div></div>